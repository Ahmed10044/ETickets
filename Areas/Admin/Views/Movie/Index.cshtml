@using ETickets.ViewModel
@model MovieAndMovieActorsVM





<!-- Movies Table -->
<section id="movies" class="p-6 rounded-2xl bg-gray-900/60 shadow-xl mb-6">
    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
        <h2 class="font-semibold text-xl text-white">🎬 Movies</h2>
        <div class="flex items-center gap-3">
            <a href="/admin/movie/create" class="py-1.5 px-4 rounded-lg bg-indigo-600 text-sm text-white hover:bg-indigo-700 transition">
                + Add Movie
            </a>
            <button class="py-1.5 px-4 rounded-lg bg-gray-700 text-sm text-white hover:bg-gray-600 transition">
                ⬇ Export
            </button>
        </div>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto rounded-xl border border-gray-700/50">
        <table class="min-w-full text-left text-sm text-gray-300">
            <thead class="text-xs uppercase bg-gray-800/80 text-slate-300 sticky top-0">
                <tr>
                    <th class="p-3">ID</th>
                    <th class="p-3">Poster</th>
                    <th class="p-3">Title</th>
                    <th class="p-3">Description</th>
                    <th class="p-3">Price</th>
                    <th class="p-3">Actors</th>
                    <th class="p-3">Start Date</th>
                    <th class="p-3">End Date</th>
                    <th class="p-3">Status</th>
                    <th class="p-3">Category</th>
                    <th class="p-3">Cinema</th>
                    <th class="p-3">Trailer</th>
                    <th class="p-3">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Movies)
                {
                    <tr class="align-top border-b border-gray-700 hover:bg-gray-800/60 transition">

                        <!-- Id -->
                        <td class="p-3 font-medium text-white">@item.Id</td>

                        <!-- Poster -->
                        <td class="p-3">
                            <img src="~/images/movies/@item.ImgUrl" class="w-16 h-24 object-cover rounded-lg shadow-md" />
                        </td>

                        <!-- Title -->
                        <td class="p-3 font-medium text-white">@item.Name</td>

                        <!-- Description (truncate but hover shows full) -->
                        <td class="p-3 max-w-xs truncate text-slate-400" title="@item.Description">
                            @item.Description
                        </td>

                        <!-- Price -->
                        <td class="p-3 font-semibold text-green-400">$@item.Price</td>

                        <!-- Actors -->
                        <td class="p-3">
                            <div class="flex flex-wrap gap-1">
                                @foreach (var a in Model.ActorMovies.Where(e => e.MovieId == item.Id))
                                {
                                    <span class="inline-flex items-center gap-1 bg-gray-700 text-white text-xs px-2 py-1 rounded-full">
                                        <img src="~/images/cast/@a.Actor.ProfilePicture" class="w-5 h-5 rounded-full object-cover" />
                                        @a.Actor.FirstName
                                    </span>
                                }
                            </div>
                        </td>

                        <!-- Start Date -->
                        <td class="p-3">@item.StartDate.ToString("yyyy-MM-dd")</td>

                        <!-- End Date -->
                        <td class="p-3">@item.EndDate.ToString("yyyy-MM-dd")</td>

                        <!-- Status -->
                        <td class="p-3">
                            @{
                                var statusColor = item.MovieStatus.ToString() == "Available" ? "bg-green-600"
                                : item.MovieStatus.ToString() == "Expired" ? "bg-red-600"
                                : "bg-yellow-600";
                            }
                            <span class="inline-block px-3 py-1 text-sm font-medium text-white rounded-lg @statusColor">
                                @item.MovieStatus
                            </span>
                        </td>

                        <!-- Category -->
                        <td class="p-3">@item.category?.Name</td>

                        <!-- Cinema -->
                        <td class="p-3">@item.cinema?.Name</td>

                        <!-- Trailer -->
                        <td class="p-3">
                            <a href="@item.TrailerUrl" target="_blank" class="text-indigo-400 hover:underline">
                                ▶ Watch
                            </a>
                        </td>

                        <!-- Actions -->
                        <td class="p-3 flex gap-2">
                            <a href="/admin/movie/Edit/@item.Id" class="py-1 px-3 rounded-lg bg-yellow-500/80 hover:bg-yellow-500 text-white text-xs shadow">
                                ✏ Edit
                            </a>
                            <a href="/admin/movie/Delete/@item.Id" class="py-1 px-3 rounded-lg bg-red-600/80 hover:bg-red-600 text-white text-xs shadow">
                                🗑 Delete
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</section>
