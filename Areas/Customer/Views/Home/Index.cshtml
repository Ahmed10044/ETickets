
@model List<Movie>
@{
    ViewData["Title"] = "Home Page";
}

<body>

    <section class="py-3 filter-bar">
        <div class="container">
            <div class="row" style="background-color: rgba(var(--bs-light-rgb), var(--bs-bg-opacity)) !important;">
                <div class="col-12">
                    <form>
                        <div class="row">
                            <!-- Movie Name -->
                            <div class="col-md-3">
                                <input type="text" class="form-control" placeholder="MovieName" name="MovieName" value="@ViewBag.MovieName">
                            </div>

                            @* <!-- Category --> *@
                            @* <div class="col-md-2"> *@
                            @*     <input type="text" class="form-control" placeholder="Category" name="CategoryId" value="@ViewBag.CategoryId"> *@
                            @* </div> *@
                            <!-- Cinema -->
                            @* <div class="col-md-2"> *@
                            @*     <input type="text" class="form-control" placeholder="Cinema" name="CinemaId" value="@ViewBag.CinemaId"> *@
                            @* </div> *@
                            <!-- Category -->
                            <div class="col-md-2">
                                <select name="CategoryId" class="form-control">
                                    <option value="">--Select Category--</option>
                                    @foreach (var item in ViewBag.Categories)
                                    {
                                        if (item.Id == ViewBag.CategoryId)
                                        {
                                            <option value="@item.Id"selected> @item.Name </option>
                                        }
                                        else
                                        {
                                            <option value="@item.Id"> @item.Name </option>
                                        }
                                    }
                                </select>
                            </div>
                            <!-- Cinema -->
                            <div class="col-md-2">
                                <select name="CinemaId" class="form-control">
                                    <option value="">--Select Cinema--</option>
                                    @foreach (var item in ViewBag.Cinemas)
                                    {
                                        if (item.Id == ViewBag.CinemaId)
                                        {
                                            <option value="@item.Id"selected> @item.Name </option>
                                        }
                                        else
                                        {
                                            <option value="@item.Id"> @item.Name </option>
                                        }
                                    }
                                </select>
                            </div>
                            <!-- Submit Button -->
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-dark w-100">Filter</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <div class="container mt-5">
        <div class="row g-4">
            @if (Model.Any())
            {
                @foreach (var item in Model)
                {
                    <div class="col-md-6 col-lg-4">
                        <div class="p-3 bg-black movie-card">
                            <h5 class="fw-bold">@item.Name</h5>
                            <img src="~/images/movies/@item.ImgUrl" alt="Poster" class="img-fluid movie-poster mb-3">
                            <p><strong>Price:</strong> <span class="badge bg-secondary">@item.Price</span></p>
                            <p><strong>Cinema:</strong> @item.cinema.Name</p>
                            <p><strong>Start Date:</strong> @item.StartDate</p>
                            <p><strong>End Date:</strong> @item.EndDate</p>
                            <p><strong>Category:</strong> <a href="#">@item.category.Name</a></p>
                            @if (item.MovieStatus ==MovieStatus.Expired)
                            {
                                <button class="mb-3 px-3 py-1 rounded-lg bg-white-600 text-black text-sm font-medium" disabled>
                                    @item.MovieStatus
                                </button>

                                <br>
                            }
                            else
                            {
                            <button class="btn-available mb-3">@item.MovieStatus</button><br>
                            }
                            <a href="/customer/home/details/@item.Id" class="btn btn-outline-secondary me-2">More Details</a>
                            @if (item.MovieStatus == MovieStatus.Expired)
                            {
                                <button class="btn px-3 py-1 rounded-lg bg-gray-600 text-white text-sm font-medium" disabled>
                                    Booking Closed
                                </button>
                            }
                            else
                            {
                            <button  class="btn btn-success" >Book Ticket</button>
                                
                            }
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="col mb-5 display-5">
                    NO ITEMS!!
                </div>
            }
          
            
        </div>
    </div>

    <div class="row">
        <div class="col-12 d-flex justify-content-center">
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                    @if (ViewBag.currentPage > 1)
                    {
                        <li class="page-item"><a class="page-link" href="/?page=@(ViewBag.currentPage-1)">Previous</a></li>
                    }

                    @for (var i = 1; i <= ViewBag.totalNumberOfPages; i++)
                    {
                        @if (i == ViewBag.currentPage)
                        {
                            <li class="page-item active"><a class="page-link" href="/?MovieName=@ViewBag.Name">@i</a></li>
                        }
                        else
                        {
                            <li class="page-item"><a class="page-link" href="/?MovieName=@ViewBag.Name">@i</a></li>
                        }

                    }

                    @if (ViewBag.currentPage != ViewBag.totalNumberOfPages && Model.Any())
                    {
                        <li class="page-item"><a class="page-link" href="/?page=@(ViewBag.currentPage+1)">Next</a></li>
                    }
                </ul>
            </nav>
        </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
